<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,
                                   initial-scale=1,
                                   minimum-scale=1,
                                   maximum-scale=1,
                                   user-scalable=no,
                                   minimal-ui">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">

    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <title>Coding Guidelines - Vanadium</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,400,400italic,500,500italic,700,700italic|Source+Code+Pro">

    <link rel="stylesheet" href="/vanadium-website/2016/css/github.css">
    <link rel="stylesheet" href="/vanadium-website/2016/css/material.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <script src="/vanadium-website/2016/js/react-0.14.3.min.js"></script>
    <script src="/vanadium-website/2016/js/react-dom-0.14.3.min.js"></script>

    <link rel="apple-touch-icon" sizes="57x57" href="/vanadium-website/2016/favicons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/vanadium-website/2016/favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/vanadium-website/2016/favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/vanadium-website/2016/favicons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/vanadium-website/2016/favicons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/vanadium-website/2016/favicons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/vanadium-website/2016/favicons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/vanadium-website/2016/favicons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/vanadium-website/2016/favicons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/vanadium-website/2016/favicons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/vanadium-website/2016/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/vanadium-website/2016/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="160x160" href="/vanadium-website/2016/favicons/favicon-160x160.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/vanadium-website/2016/favicons/favicon-192x192.png">
    <meta name="msapplication-TileColor" content="#00acc1">
    <meta name="msapplication-TileImage" content="/vanadium-website/2016/favicons/mstile-144x144.png">

    <link rel="stylesheet" href="/vanadium-website/2016/css/bundle.cyan.css">
    <script src="/vanadium-website/2016/js/bundle.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59720824-6', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <header class="mdl-shadow--2dp">
      <div class="row">
        <div class="icon menu"><i class="material-icons">menu</i></div>
        <div class="icon v-icon"><a href="/vanadium-website/2016/"><img src="/vanadium-website/2016/images/v-icon-white.svg"></a></div>
        <div class="logo"><a href="/vanadium-website/2016/core.html">Vanadium Core</a></div>
        <div class="spacer"></div>
        <nav>
          <a href="/vanadium-website/2016/core.html">Overview</a>
          <a href="/vanadium-website/2016/installation/">Installation</a>
          <a href="/vanadium-website/2016/tutorials/hello-world.html">Tutorials</a>
        </nav>
      </div>
    </header>
    <div data-subsite="core" class="sidebar"></div>
    <div class="sidebar-data">
      <a href="/vanadium-website/2016/core.html">Overview</a>
      <a href="/vanadium-website/2016/installation/">Installation</a>

      <a href="#" class="nav">Tutorials</a>
      <nav>
        <a href="/vanadium-website/2016/tutorials/hello-world.html">Hello World</a>
        <a href="/vanadium-website/2016/tutorials/basics.html">Client/Server Basics</a>

        <a href="#" class="nav">Security</a>
        <nav>
          <a href="/vanadium-website/2016/tutorials/security/">Overview</a>
          <a href="/vanadium-website/2016/tutorials/security/principals-and-blessings.html">Principals and Blessings</a>
      <a href="/vanadium-website/2016/tutorials/security/permissions-authorizer.html">Permissions Authorizer</a>
      <a href="/vanadium-website/2016/tutorials/security/first-party-caveats.html">Caveats</a>
      <a href="/vanadium-website/2016/tutorials/security/third-party-caveats.html">Third-party Caveats</a>
      <a href="/vanadium-website/2016/tutorials/security/agent.html">The Agent</a>
      <a href="/vanadium-website/2016/tutorials/security/custom-authorizer.html">Custom Authorizer</a>
    </nav>

        <a href="#" class="nav">Naming</a>
        <nav>
          <a href="/vanadium-website/2016/tutorials/naming/">Overview</a>
          <a href="/vanadium-website/2016/tutorials/naming/mount-table.html">The Mount Table</a>
      <a href="/vanadium-website/2016/tutorials/naming/namespace.html">Namespaces</a>
      <a href="/vanadium-website/2016/tutorials/naming/suffix-part1.html">The Suffix - Part I</a>
      <a href="/vanadium-website/2016/tutorials/naming/suffix-part2.html">The Suffix - Part II</a>
      <a href="/vanadium-website/2016/tutorials/naming/globber.html">Globber</a>
    </nav>

        <a href="#" class="nav">Syncbase</a>
        <nav>
          <a href="/vanadium-website/2016/tutorials/syncbase/">Overview</a>
          <a href="/vanadium-website/2016/tutorials/syncbase/sync.html">Syncing</a>
      <a href="/vanadium-website/2016/tutorials/syncbase/localPersist.html">Local Persistence</a>
    </nav>

        <a href="#" class="nav">Java</a>
        <nav>
          <a href="/vanadium-website/2016/tutorials/java/">Overview</a>
          <a href="/vanadium-website/2016/tutorials/java/fortune.html">Fortune in Java</a>
      <a href="/vanadium-website/2016/tutorials/java/android.html">Location Service in Android</a>
    </nav>

        <a href="/vanadium-website/2016/tutorials/faq.html">Tutorial FAQ</a>
      </nav>

      <a href="#" class="nav">Concepts</a>
      <nav>
        <a href="/vanadium-website/2016/concepts/rpc.html">RPC System</a>
    <a href="/vanadium-website/2016/concepts/naming.html">Naming</a>
    <a href="/vanadium-website/2016/concepts/security.html">Security</a>
    <a href="/vanadium-website/2016/concepts/device-management.html">Device Management</a>
  </nav>

      <a href="/vanadium-website/2016/example-apps.html">Example Apps</a>
      <a href="/vanadium-website/2016/api-reference.html">API Reference</a>

      <a href="#" class="nav">Community</a>
      <nav>
        <a href="/vanadium-website/2016/community/coding-guidelines.html">Coding Guidelines</a>
    <a href="/vanadium-website/2016/community/contributing.html">Contributing</a>
    <a href="/vanadium-website/2016/community/mailing-lists.html">Mailing List</a>
    <a href="/vanadium-website/2016/community/roadmap.html">Roadmap</a>
  </nav>

      <a href="#" class="nav">Tools</a>
      <nav>
        <a href="/vanadium-website/2016/tools/identity-service-faq.html">Vanadium Identity Service</a>
    <a href="/vanadium-website/2016/tools/jiri.html">Jiri</a>
    <a href="/vanadium-website/2016/tools/namespace-browser.html">Namespace Browser</a>
    <a href="/vanadium-website/2016/tools/services.html">Vanadium Cloud Services</a>
  </nav>

      <a href="#" class="nav">Design Docs</a>
      <nav>
        <a href="/vanadium-website/2016/designdocs/authentication.html">Authentication Protocol</a>
    <a href="/vanadium-website/2016/designdocs/identity-service.html">Identity Service</a>
    <a href="/vanadium-website/2016/designdocs/vdl-spec.html">VDL Specification</a>
    <a href="/vanadium-website/2016/designdocs/vom-spec.html">VOM Specification</a>
  </nav>

      <a href="/vanadium-website/2016/glossary.html">Glossary</a>
      <a href="/vanadium-website/2016/faq.html">FAQ</a>
      <a href="/vanadium-website/2016/tos.html">Terms of Service</a>
    </div>
    <main>
      <h1 class="title">

        Coding Guidelines
      </h1>

      <div class="toc"></div>

      <h1 id="code-organization">Code organization</h1>
<p>Vanadium is spread across multiple <a href="https://github.com/vanadium">git repositories</a>. The [contributor
installation] process arranges these repositories as follows (some repositories
omitted, for brevity):</p>
<pre><code> $JIRI_ROOT
   .jiri_root        # Jiri utils and metadata
     bin             # Contributor tool binaries
     scripts/jiri    # Jiri command-line tool
   environment       # Platform-dependent configuration
   manifest          # Multi-repo configuration data
   release           # Source code
     go/src/v.io/v23 # Interfaces
     go/src/v.io/x   # Implementation
       devtools      # Contributor tool source code
       lib           # Developer libs
       ref           # Reference implementation of v23
     javascript      # JS interfaces and implementation
     projects        # Example apps
       playground    # Write/build/run v23 code on the web
       browser       # Vanadium namespace browser
       chat          # Chat program
   third_party       # Third-party code
   website           # Source for this site
</code></pre><p>Each repository has a <code>README.md</code> file summarizing its purpose.  The <code>manifest</code>
repository contains the configuration that describes this repository
arrangement.</p>
<p>Things move around, so its best to examine your local installation for the
latest arrangement.</p>
<!--
TODO:
- Suggestions for how to name things (hyphens vs. underscores).
- Using optional arguments: variadic functions / varargs vs. Options structs.
-->
<h1 id="go">Go</h1>
<p>Use <a href="https://golang.org/cmd/gofmt/">gofmt</a> and suggestions from <a href="http://golang.org/doc/effective_go.html">Effective Go</a>.</p>
<h2 id="interfaces">Interfaces</h2>
<p>Vanadium interfaces are defined in the <a href="https://github.com/vanadium/go.v23"><code>go/src/v.io/v23</code></a>
tree in files named <code>model.go</code>.  For example, the file
<a href="https://github.com/vanadium/go.v23/blob/master/security/model.go"><code>security/model.go</code></a> holds security interface
definitions.</p>
<h2 id="testing">Testing</h2>
<p>A test for package <code>foo</code> should be in package <code>foo_test</code>. This way, tests can
depend on anything they like without introducing cycles or affecting non-test
binaries.</p>
<p>If a test must touch the internals of some package <code>foo</code>, that test can be in
package <code>foo</code>, but must keep its dependencies to a minimum, and must have a name
that ends with <code>_internal_test.go</code>.</p>
<p>Most tests should import the <a href="https://github.com/vanadium/go.ref/tree/master/test"><code>v.io/x/ref/test</code> package</a>
and invoke its <a href="https://github.com/vanadium/go.ref/blob/master/test/init.go"><code>Init</code> function</a> in order to configure
logging, random number generators etc. Doing so will assist in
debugging failing tests. For example:</p>
<ul>
<li>The <code>-vv</code> and <code>-vmodule</code> flags can be used to control logging verbosity</li>
<li>The seed of the random number generator is logged when running tests. This
is useful when trying to reproduce failures that may not occur when the
random number generator is seeded differently.</li>
</ul>
<!-- TODO: Explain modules, expect, timekeeper? -->
<!-- TODO: Describe dependency management (apis vs. impls, what can depend on
what). -->
<h1 id="vdl">VDL</h1>
<p>The <code>vdl</code> tool uses VDL files to generate files containing <a href="/vanadium-website/2016/glossary.html#remote-procedure-call-rpc-">RPC</a> stub code for
various languages - Go, Java, JavaScript, etc.</p>
<p><a href="/vanadium-website/2016/glossary.html#vandium-definition-language-vdl-">VDL</a> is not Go, but is modeled after Go, so VDL code should follow
Go&#39;s style guidelines.</p>
<p>VDL files have a <a href="https://golang.org/doc/code.html#PackagePaths">Go-like notion of packages</a>.  Go code
generated from a VDL file must appear in a location that respects both
the VDL file&#39;s package name and the value of <code>GOPATH</code>.  In a Go-based
project like Vanadium, the simplest way to accomplish this is to place
VDL source files into the <code>go/src</code> tree at the location that the
generated Go should be placed.</p>
<h1 id="shell">Shell</h1>
<p>We prefer Go programs over shell scripts for jobs traditionally given
to shell scripts.</p>
<p>If you must write a shell script, follow the
<a href="https://google-styleguide.googlecode.com/svn/trunk/shell.xml">Google Shell Style Guide</a>.</p>

    </main>
  </body>
</html>
