<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,
                                   initial-scale=1,
                                   minimum-scale=1,
                                   maximum-scale=1,
                                   user-scalable=no,
                                   minimal-ui">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">

    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <title>Syncing - Vanadium</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,400,400italic,500,500italic,700,700italic|Source+Code+Pro">

    <link rel="stylesheet" href="/vanadium-website/2016/css/github.css">
    <link rel="stylesheet" href="/vanadium-website/2016/css/material.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <script src="/vanadium-website/2016/js/react-0.14.3.min.js"></script>
    <script src="/vanadium-website/2016/js/react-dom-0.14.3.min.js"></script>

    <link rel="apple-touch-icon" sizes="57x57" href="/vanadium-website/2016/favicons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/vanadium-website/2016/favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/vanadium-website/2016/favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/vanadium-website/2016/favicons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/vanadium-website/2016/favicons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/vanadium-website/2016/favicons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/vanadium-website/2016/favicons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/vanadium-website/2016/favicons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/vanadium-website/2016/favicons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/vanadium-website/2016/favicons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/vanadium-website/2016/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/vanadium-website/2016/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="160x160" href="/vanadium-website/2016/favicons/favicon-160x160.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/vanadium-website/2016/favicons/favicon-192x192.png">
    <meta name="msapplication-TileColor" content="#00acc1">
    <meta name="msapplication-TileImage" content="/vanadium-website/2016/favicons/mstile-144x144.png">

    <link rel="stylesheet" href="/vanadium-website/2016/css/bundle.cyan.css">
    <script src="/vanadium-website/2016/js/bundle.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59720824-6', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <header class="mdl-shadow--2dp">
      <div class="row">
        <div class="icon menu"><i class="material-icons">menu</i></div>
        <div class="icon v-icon"><a href="/vanadium-website/2016/"><img src="/vanadium-website/2016/images/v-icon-white.svg"></a></div>
        <div class="logo"><a href="/vanadium-website/2016/core.html">Vanadium Core</a></div>
        <div class="spacer"></div>
        <nav>
          <a href="/vanadium-website/2016/core.html">Overview</a>
          <a href="/vanadium-website/2016/installation/">Installation</a>
          <a href="/vanadium-website/2016/tutorials/hello-world.html">Tutorials</a>
        </nav>
      </div>
    </header>
    <div data-subsite="core" class="sidebar"></div>
    <div class="sidebar-data">
      <a href="/vanadium-website/2016/core.html">Overview</a>
      <a href="/vanadium-website/2016/installation/">Installation</a>

      <a href="#" class="nav">Tutorials</a>
      <nav>
        <a href="/vanadium-website/2016/tutorials/hello-world.html">Hello World</a>
        <a href="/vanadium-website/2016/tutorials/basics.html">Client/Server Basics</a>

        <a href="#" class="nav">Security</a>
        <nav>
          <a href="/vanadium-website/2016/tutorials/security/">Overview</a>
          <a href="/vanadium-website/2016/tutorials/security/principals-and-blessings.html">Principals and Blessings</a>
      <a href="/vanadium-website/2016/tutorials/security/permissions-authorizer.html">Permissions Authorizer</a>
      <a href="/vanadium-website/2016/tutorials/security/first-party-caveats.html">Caveats</a>
      <a href="/vanadium-website/2016/tutorials/security/third-party-caveats.html">Third-party Caveats</a>
      <a href="/vanadium-website/2016/tutorials/security/agent.html">The Agent</a>
      <a href="/vanadium-website/2016/tutorials/security/custom-authorizer.html">Custom Authorizer</a>
    </nav>

        <a href="#" class="nav">Naming</a>
        <nav>
          <a href="/vanadium-website/2016/tutorials/naming/">Overview</a>
          <a href="/vanadium-website/2016/tutorials/naming/mount-table.html">The Mount Table</a>
      <a href="/vanadium-website/2016/tutorials/naming/namespace.html">Namespaces</a>
      <a href="/vanadium-website/2016/tutorials/naming/suffix-part1.html">The Suffix - Part I</a>
      <a href="/vanadium-website/2016/tutorials/naming/suffix-part2.html">The Suffix - Part II</a>
      <a href="/vanadium-website/2016/tutorials/naming/globber.html">Globber</a>
    </nav>

        <a href="#" class="nav">Syncbase</a>
        <nav>
          <a href="/vanadium-website/2016/tutorials/syncbase/">Overview</a>
          <a href="/vanadium-website/2016/tutorials/syncbase/sync.html">Syncing</a>
      <a href="/vanadium-website/2016/tutorials/syncbase/localPersist.html">Local Persistence</a>
    </nav>

        <a href="#" class="nav">Java</a>
        <nav>
          <a href="/vanadium-website/2016/tutorials/java/">Overview</a>
          <a href="/vanadium-website/2016/tutorials/java/fortune.html">Fortune in Java</a>
      <a href="/vanadium-website/2016/tutorials/java/android.html">Location Service in Android</a>
    </nav>

        <a href="/vanadium-website/2016/tutorials/faq.html">Tutorial FAQ</a>
      </nav>

      <a href="#" class="nav">Concepts</a>
      <nav>
        <a href="/vanadium-website/2016/concepts/rpc.html">RPC System</a>
    <a href="/vanadium-website/2016/concepts/naming.html">Naming</a>
    <a href="/vanadium-website/2016/concepts/security.html">Security</a>
    <a href="/vanadium-website/2016/concepts/device-management.html">Device Management</a>
  </nav>

      <a href="/vanadium-website/2016/example-apps.html">Example Apps</a>
      <a href="/vanadium-website/2016/api-reference.html">API Reference</a>

      <a href="#" class="nav">Community</a>
      <nav>
        <a href="/vanadium-website/2016/community/coding-guidelines.html">Coding Guidelines</a>
    <a href="/vanadium-website/2016/community/contributing.html">Contributing</a>
    <a href="/vanadium-website/2016/community/mailing-lists.html">Mailing List</a>
    <a href="/vanadium-website/2016/community/roadmap.html">Roadmap</a>
  </nav>

      <a href="#" class="nav">Tools</a>
      <nav>
        <a href="/vanadium-website/2016/tools/identity-service-faq.html">Vanadium Identity Service</a>
    <a href="/vanadium-website/2016/tools/jiri.html">Jiri</a>
    <a href="/vanadium-website/2016/tools/namespace-browser.html">Namespace Browser</a>
    <a href="/vanadium-website/2016/tools/services.html">Vanadium Cloud Services</a>
  </nav>

      <a href="#" class="nav">Design Docs</a>
      <nav>
        <a href="/vanadium-website/2016/designdocs/authentication.html">Authentication Protocol</a>
    <a href="/vanadium-website/2016/designdocs/identity-service.html">Identity Service</a>
    <a href="/vanadium-website/2016/designdocs/vdl-spec.html">VDL Specification</a>
    <a href="/vanadium-website/2016/designdocs/vom-spec.html">VOM Specification</a>
  </nav>

      <a href="/vanadium-website/2016/glossary.html">Glossary</a>
      <a href="/vanadium-website/2016/faq.html">FAQ</a>
      <a href="/vanadium-website/2016/tos.html">Terms of Service</a>
    </div>
    <main>
      <h1 class="title">

        Syncing
      </h1>

      <p class="wherein"><strong>Wherein</strong> we distribute the fortune teller service state across multiple devices using Syncbase.</p>

      <div class="toc"></div>

      <div class="prerequisites">
      <div class="note info"><p><strong>Prerequisites</strong>:<br>
All tutorials require Vanadium <a href="/vanadium-website/2016/installation/">installation</a>, and must run in a <a href="/vanadium-website/2016/tutorials/faq.html#why-bash-">bash shell</a>.
<br>Further, please <a href="/vanadium-website/2016/sh/scenario-f-setup.sh" download="scenario-f-setup.sh"> download this script</a> then <a href="/vanadium-website/2016/tutorials/faq.html#why-source-">source</a> it:</p>
<pre><code>source ~/Downloads/scenario-f-setup.sh
</code></pre><p>This command wipes tutorial files and defines shell environment variables. If you start a new terminal, and just want to re-establish the environment, see instructions <a href="/vanadium-website/2016/tutorials/setup.html">here</a>.
</p>
<p>
If you would like to generate files from this tutorial without the copy/paste steps, download and source <a href="/vanadium-website/2016/sh/tut-completer-syncbase-sync.sh" download="tut-completer-syncbase-sync.sh">this script</a>. Files will be created in the <code>$V_TUT</code> <a href="/vanadium-website/2016/tutorials/setup.html">directory</a>.
</p>
</div>
</div>

      <h1 id="introduction">Introduction</h1>
<p>In this tutorial, we will extend the Syncbase <a href="/vanadium-website/2016/tutorials/syncbase/localPersist.html">local persistence tutorial</a> so
that multiple fortune teller services can <em>exchange</em> data.</p>
<p>Syncbase uses collections as the unit of synchronization. Devices join groups
called <em>syncgroups</em>, and each syncgroup manages one or more collections and
ensures that each device in the syncgroup receives updates to its collections.
In this tutorial we will add the fortune collection from the <a href="/vanadium-website/2016/tutorials/syncbase/localPersist.html">local persistence
tutorial</a> to a new syncgroup, and then add multiple fortune services to the same
syncgroup in order to exchange data between them.</p>
<h1 id="modifying-the-service">Modifying the Service</h1>
<p>First, we need to modify the service to join a syncgroup, and make small changes to the
<code>Add</code> and <code>Get</code> RPCs.</p>
<!-- @defineService @test @completer -->
<pre><code>mkdir -p $V_TUT/src/fortune/service
 cat - &lt;&lt;EOF &gt;$V_TUT/src/fortune/service/service.go
{#dim}{#dim-children}package service

import (
  &quot;fortune/ifc&quot;
  &quot;math/rand&quot;
  &quot;strconv&quot;
  &quot;strings&quot;
  &quot;sync&quot;

  &quot;v.io/v23/context&quot;
  &quot;v.io/v23/rpc&quot;
  &quot;v.io/v23/security&quot;
  &quot;v.io/v23/security/access&quot;
  wire &quot;v.io/v23/services/syncbase&quot;
  &quot;v.io/v23/syncbase&quot;
)

// Constant names of different Syncbase entities.
const (
  fortuneDatabaseName   = &quot;fortuneDb&quot;
  fortuneCollectionName = &quot;fortuneCollection&quot;{/dim-children}{/dim}
  fortuneSyncgroupName  = &quot;fortuneSyncgroup&quot;
{#dim}{#dim-children}  // A special key that specifies the number of fortunes.
  numFortunesKey = &quot;numFortunes&quot;
)

type impl struct {
  random *rand.Rand   // To pick a random fortune
  mu     sync.RWMutex // To safely enable concurrent use.

  syncbaseName       string // The Syncbase endpoint
  remoteSyncbaseName string // A remote endpoint to connect to

  sbs syncbase.Service    // Handle to the Syncbase service
  d   syncbase.Database   // Handle to the fortunes database
  c   syncbase.Collection // Handle to the fortunes collection
}

// Makes an implementation.
func Make(ctx *context.T, syncbaseName, remoteSyncbaseName string) ifc.FortuneServerMethods {
  impl := &amp;impl{
    random:             rand.New(rand.NewSource(99)),
    syncbaseName:       syncbaseName,{/dim-children}{/dim}
    remoteSyncbaseName: remoteSyncbaseName,
{#dim}{#dim-children}  }

  if err := impl.initSyncbase(ctx); err != nil {
    panic(err)
  }
  return impl
}

// Initialize Syncbase by establishing a new service and creating a new database
// and a new collection.
func (f *impl) initSyncbase(ctx *context.T) error {

  // Create a new service and get its database.
  sbs := syncbase.NewService(f.syncbaseName)
  d := sbs.Database(ctx, fortuneDatabaseName, nil)
  if err := d.Create(ctx, nil); err != nil {
    return err
  }

  // Create the collection where we will store fortunes.
  c := d.Collection(ctx, fortuneCollectionName)
  if err := c.Create(ctx, nil); err != nil {
    return err
  }{/dim-children}{/dim}
  // Join a syncgroup if there is someone to connect to, otherwise create one.
  sg := d.Syncgroup(ctx, fortuneSyncgroupName)
  sgPerms := access.Permissions{}
  sgPerms.Add(security.BlessingPattern(sg.Id().Blessing),
    access.TagStrings(wire.AllSyncgroupTags...)...)

  sgSpec := wire.SyncgroupSpec{
    Description: &quot;FortuneSyncgroup&quot;,
    Perms:       sgPerms,
    Collections: []wire.Id{c.Id()},
  }
  sgInfo := wire.SyncgroupMemberInfo{SyncPriority: 10}

  if f.remoteSyncbaseName != &quot;&quot; {
    if _, err := sg.Join(ctx, f.remoteSyncbaseName, nil, sgInfo); err != nil {
      return err
    }
  } else {
    if err := sg.Create(ctx, sgSpec, sgInfo); err != nil {
      return err
    }
  }
{#dim}{#dim-children}  f.sbs = sbs
  f.d = d
  f.c = c
  return nil
}

// Get RPC implementation. Returns a fortune retrieved from Syncbase.
func (f *impl) Get(ctx *context.T, _ rpc.ServerCall) (string, error) {
  f.mu.RLock()
  defer f.mu.RUnlock(){/dim-children}{/dim}
  counts := make([]int, 0)
  devices := make([]string, 0)
  it := f.c.Scan(ctx, syncbase.Prefix(numFortunesKey))
  for it.Advance() {
    var numFortunes int
    dev := strings.TrimPrefix(it.Key(), numFortunesKey)
    if err := it.Value(&amp;numFortunes); err != nil {
      return &quot;[error]&quot;, err
    }

    if numFortunes &gt; 0 {
      counts = append(counts, numFortunes)
      devices = append(devices, dev)
    }
  }

  if len(counts) == 0 {
    return &quot;[empty]&quot;, nil
  }

  index := f.random.Intn(len(counts))
  count := counts[index]
  dev := devices[index]

  // Get a random number in the range [0, numKeys) and convert it to a string;
  // this acts as the key in the fortunes collection.
  key := strconv.Itoa(f.random.Intn(count)) + dev
{#dim}{#dim-children}  var value string
  if err := f.c.Get(ctx, key, &amp;value); err == nil {
    return value, nil
  } else {
    return &quot;[error]&quot;, err
  }
}

// Add RPC implementation. Adds a new fortune by persisting it to Syncbase.
func (f *impl) Add(ctx *context.T, _ rpc.ServerCall, fortune string) error {
  f.mu.Lock()
  defer f.mu.Unlock(){/dim-children}{/dim}

  var numKeys int
  if err := f.c.Get(ctx, numFortunesKey+f.syncbaseName, &amp;numKeys); err != nil {
    numKeys = 0
  }

  // Put the fortune into Syncbase.
  key := strconv.Itoa(numKeys)
  if err := f.c.Put(ctx, key+f.syncbaseName, &amp;fortune); err != nil {
    return err
  }

  // Update the number of keys.
  return f.c.Put(ctx, numFortunesKey+f.syncbaseName, numKeys+1)

{#dim}{#dim-children}}{/dim-children}{/dim}


EOF
</code></pre><p><strong>Code Walk</strong><br></p>
<p>Our <code>Make</code> function now takes one new argument: a <code>remoteSyncbaseName</code>. This
name points to another existing Syncbase instance that this service will use to
join the syncgroup. If the name is an empty string, then the service is
responsible for creating the syncgroup (and other services will use the service
as their remote).</p>
<p>The new code in the <code>initSyncbase</code> function sets up permissions on the new
syncgroup, adds the fortune collection to it, and then tries to join a syncgroup
or creates one if no remote exists.</p>
<p>We have changed all our <code>Get</code> and <code>Put</code> calls to Syncbase by appending the
(unique) Syncbase name to each key. This is because by default, Syncbase uses a
<em>last write wins</em> policy to resolve conflicts to the same key. A conflict arises
when two Syncbases attempt to update a value for the same key.</p>
<p>As an example of a potential conflict, consider updating the <code>numFortunesKey</code>
value concurrently on two services. If both services update the value from 1 to
2, it means two fortunes were added (one by each service), and the true value
should be 3. Instead, Syncbase will simply pick the latest value
written (2 in this scenario), and our data will be inconsistent. Adding a unique
identifier for each key prevents these conflicts since concurrent updates to the
same key never occur.</p>
<p>This makes the <code>Get</code> RPC slightly more complex. We use the <code>Scan</code> method with a
prefix to read the number of fortunes <em>each</em> Syncbase has added (each number is
stored in a unique key, but Syncbase can perform scan on <em>prefixes</em>). We pick
one of the Syncbases at random, and then randomly pick one of the fortunes from
that Syncbase.</p>
<h1 id="server">Server</h1>
<p>The server requires a small change: we need to pass a remote Syncbase name to
the service&#39;s <code>Make</code> function.</p>
<!-- @defineServer @test @completer -->
<pre><code>mkdir -p $V_TUT/src/fortune/server
 cat - &lt;&lt;EOF &gt;$V_TUT/src/fortune/server/main.go
package main

{#dim}{#dim-children}import (
  &quot;fmt&quot;
  &quot;flag&quot;
  &quot;fortune/ifc&quot;
  &quot;fortune/server/util&quot;
  &quot;fortune/service&quot;
  &quot;log&quot;

  &quot;v.io/v23&quot;
  &quot;v.io/v23/rpc&quot;
  &quot;v.io/x/ref/lib/signals&quot;
  _ &quot;v.io/x/ref/runtime/factories/generic&quot;
)

var (
  serviceName = flag.String(
    &quot;service-name&quot;, &quot;&quot;,
    &quot;Name for service in default mount table.&quot;)
  syncbaseName = flag.String(
    &quot;sb-name&quot;, &quot;&quot;,
    &quot;Name of Syncbase service&quot;){/dim-children}{/dim}
  remoteSyncbaseName = flag.String(
    &quot;remote-sb-name&quot;, &quot;&quot;,
    &quot;Name of remote Syncbase service&quot;)
{#dim}{#dim-children})

func main() {
  ctx, shutdown := v23.Init()
  defer shutdown(){/dim-children}{/dim}
  fortune := ifc.FortuneServer(service.Make(ctx, *syncbaseName,  *remoteSyncbaseName))
{#dim}{#dim-children}  // If the dispatcher isn&#39;t nil, it&#39;s presumed to have
  // obtained its authorizer from util.MakeAuthorizer().
  dispatcher := util.MakeDispatcher()

  // Start serving.
  var err error
  var server rpc.Server
  if dispatcher == nil {
    // Use the default dispatcher.
    _, server, err = v23.WithNewServer(
      ctx, *serviceName, fortune, util.MakeAuthorizer())
  } else {
    _, server, err = v23.WithNewDispatchingServer(
      ctx, *serviceName, dispatcher)
  }
  if err != nil {
    log.Panic(&quot;Error serving service: &quot;, err)
  }
  endpoint := server.Status().Endpoints[0]
  util.SaveEndpointToFile(endpoint)
  fmt.Printf(&quot;Listening at: %v\n&quot;, endpoint)

  // Wait forever.
  &lt;-signals.ShutdownOnSignals(ctx)
}{/dim-children}{/dim}

EOF
</code></pre><p>Install the client and server:</p>
<!-- @installClientServer @test @completer -->
<pre><code>go install fortune/server
go install fortune/client
</code></pre><h1 id="run-your-code">Run Your Code</h1>
<p>We will start a Syncbase instance like before:</p>
<!-- @startSb1 @test @completer @sleep -->
<pre><code>syncbased \
  --v23.credentials=$V_TUT/cred/alice \
  --v23.tcp.address=127.0.0.1:0 &gt; $V_TUT/endpoint1  2&gt; /dev/null &amp;
TUT_PID_SB1=$!
while [ ! -s $V_TUT/endpoint1 ]; do sleep 1; done
</code></pre><p>Then we will start a server:</p>
<!-- @startServer1 @test @completer @sleep -->
<pre><code>rm -f $V_TUT/server1.txt $V_TUT/server2.txt
$V_TUT/bin/server \
  --v23.credentials=$V_TUT/cred/alice \
  --v23.tcp.address=127.0.0.1:0 \
  --endpoint-file-name=$V_TUT/server1.txt \
  --sb-name=`cat $V_TUT/endpoint1 | grep &#39;ENDPOINT=&#39; | cut -d&#39;=&#39; -f2` &amp;&gt; /dev/null &amp;
TUT_PID_SERVER1=$!
</code></pre><p>Now, we will start a <em>second</em> Syncbase. We will store the
endpoint in a different file <code>$V_TUT/endpoint2</code>:</p>
<!-- @startSb2 @test @completer @sleep -->
<pre><code>syncbased \
  --v23.tcp.address=127.0.0.1:0 \
  --v23.credentials=$V_TUT/cred/alice &gt; $V_TUT/endpoint2 2&gt; /dev/null &amp;
TUT_PID_SB2=$!
while [ ! -s $V_TUT/endpoint2 ]; do sleep 1; done
</code></pre><p>Now start another server, and pass the first Syncbase endpoint as
the remote Syncbase name:</p>
<!-- @startServer2 @test @completer @sleep -->
<pre><code>$V_TUT/bin/server \
  --v23.credentials=$V_TUT/cred/alice \
  --v23.tcp.address=127.0.0.1:0 \
  --endpoint-file-name=$V_TUT/server2.txt \
  --sb-name=`cat $V_TUT/endpoint2 | grep &#39;ENDPOINT=&#39; | cut -d&#39;=&#39; -f2` \
  --remote-sb-name=`cat $V_TUT/endpoint1 | grep &#39;ENDPOINT=&#39; | cut -d&#39;=&#39; -f2` &amp;&gt; /dev/null &amp;
TUT_PID_SERVER2=$!
</code></pre><p>We can now make RPC calls:</p>
<!-- @initialClientCall @test @completer -->
<pre><code>$V_TUT/bin/client \
  --v23.credentials=$V_TUT/cred/alice \
  --server=`cat $V_TUT/server1.txt` \
  --add &quot;The greatest risk is not taking one.&quot;

$V_TUT/bin/client \
  --v23.credentials=$V_TUT/cred/alice \
  --server=`cat $V_TUT/server2.txt` \
  --add &quot;A new challenge is near.&quot;
</code></pre><p>Now get the fortunes back:</p>
<!-- @getClientCall @test @completer -->
<pre><code>$V_TUT/bin/client \
  --v23.credentials=$V_TUT/cred/alice \
  --server=`cat $V_TUT/server1.txt`
</code></pre><p>Calling the <code>Get</code> RPC above enough times should return both the first and second
fortune eventually, even though the two fortunes were added to <em>different</em>
services. Syncbases exchange data in the fortune collection using the syncgroup
we set up.</p>
<h1 id="cleanup">Cleanup</h1>
<p>To clean up, kill the servers, Syncbase instances, and remove any temporary
files.</p>
<!-- @cleanup @test @completer -->
<pre><code>kill_tut_process TUT_PID_SERVER1
kill_tut_process TUT_PID_SERVER2
kill_tut_process TUT_PID_SB1
kill_tut_process TUT_PID_SB2
rm -f $V_TUT/server1.txt
rm -f $V_TUT/server2.txt
</code></pre><h1 id="summary">Summary</h1>
<ul>
<li><p>You wrote a service which connects with Syncbase, creates a Syncbase
collection, joins a syncgroup, and issues <code>Put</code> and <code>Get</code> calls to the
collection.</p>
</li>
<li><p>You launched multiple servers and Syncbases instances, issued client RPC calls
to both, and watched the data between the two instances sync.</p>
</li>
</ul>
<p>There is a lot more you can do with Syncbase. To dive deeper, see the <a href="/vanadium-website/2016/syncbase/tutorial/introduction.html">Syncbase
tutorial</a>.</p>

    </main>
    <nav class="previous-next">
      <a href="/vanadium-website/2016/tutorials/syncbase/localPersist.html" class="next">
        <div class="text-wrapper">
          <small>Next</small>
          <div class="text">
            <span>Local Persistence</span>
          </div>
        </div>
        <div class="icon"><i class="material-icons">arrow_forward</i></div>
      </a>
</nav>
  </body>
</html>
