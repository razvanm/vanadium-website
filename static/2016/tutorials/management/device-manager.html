<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,
                                   initial-scale=1,
                                   minimum-scale=1,
                                   maximum-scale=1,
                                   user-scalable=no,
                                   minimal-ui">
  
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
  
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
    <title>The Device Manager - Vanadium</title>
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,400,400italic,500,500italic,700,700italic|Source+Code+Pro">
  
    <link rel="stylesheet" href="/2016/css/github.css">
    <link rel="stylesheet" href="/2016/css/material.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  
    <script src="/2016/js/react-0.14.3.min.js"></script>
    <script src="/2016/js/react-dom-0.14.3.min.js"></script>
  
    <link rel="apple-touch-icon" sizes="57x57" href="/2016/favicons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/2016/favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/2016/favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/2016/favicons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/2016/favicons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/2016/favicons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/2016/favicons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/2016/favicons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/2016/favicons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/2016/favicons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/2016/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/2016/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="160x160" href="/2016/favicons/favicon-160x160.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/2016/favicons/favicon-192x192.png">
    <meta name="msapplication-TileColor" content="#00acc1">
    <meta name="msapplication-TileImage" content="/2016/favicons/mstile-144x144.png">
  
    <link rel="stylesheet" href="/2016/css/bundle.cyan.css">
    <script src="/2016/js/bundle.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
      ga('create', 'UA-59720824-6', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <header class="mdl-shadow--2dp">
      <div class="row">
        <div class="icon menu"><i class="material-icons">menu</i></div>
        <div class="icon v-icon"><a href="/2016/"><img src="/2016/images/v-icon-white.svg"></a></div>
        <div class="logo"><a href="/2016/core.html">Vanadium Core</a></div>
        <div class="spacer"></div>
        <nav>
          <a href="/2016/core.html">Overview</a>
          <a href="/2016/installation/">Installation</a>
          <a href="/2016/tutorials/hello-world.html">Tutorials</a>
        </nav>
      </div>
    </header>
    <div data-subsite="core" class="sidebar"></div>
    <div class="sidebar-data">
      <a href="/2016/core.html">Overview</a>
      <a href="/2016/installation/">Installation</a>
    
      <a href="#" class="nav">Tutorials</a>
      <nav>
        <a href="/2016/tutorials/hello-world.html">Hello World</a>
        <a href="/2016/tutorials/basics.html">Client/Server Basics</a>
    
        <a href="#" class="nav">Security</a>
        <nav>
          <a href="/2016/tutorials/security/">Overview</a>
          <a href="/2016/tutorials/security/principals-and-blessings.html">Principals and Blessings</a>
      <a href="/2016/tutorials/security/permissions-authorizer.html">Permissions Authorizer</a>
      <a href="/2016/tutorials/security/first-party-caveats.html">Caveats</a>
      <a href="/2016/tutorials/security/third-party-caveats.html">Third-party Caveats</a>
      <a href="/2016/tutorials/security/agent.html">The Agent</a>
      <a href="/2016/tutorials/security/custom-authorizer.html">Custom Authorizer</a>
    </nav>
    
        <a href="#" class="nav">Naming</a>
        <nav>
          <a href="/2016/tutorials/naming/">Overview</a>
          <a href="/2016/tutorials/naming/mount-table.html">The Mount Table</a>
      <a href="/2016/tutorials/naming/namespace.html">Namespaces</a>
      <a href="/2016/tutorials/naming/suffix-part1.html">The Suffix - Part I</a>
      <a href="/2016/tutorials/naming/suffix-part2.html">The Suffix - Part II</a>
      <a href="/2016/tutorials/naming/globber.html">Globber</a>
    </nav>
    
        <a href="#" class="nav">Syncbase</a>
        <nav>
          <a href="/2016/tutorials/syncbase/">Overview</a>
          <a href="/2016/tutorials/syncbase/sync.html">Syncing</a>
      <a href="/2016/tutorials/syncbase/localPersist.html">Local Persistence</a>
    </nav>
    
        <a href="#" class="nav">Java</a>
        <nav>
          <a href="/2016/tutorials/java/">Overview</a>
          <a href="/2016/tutorials/java/fortune.html">Fortune in Java</a>
      <a href="/2016/tutorials/java/android.html">Location Service in Android</a>
    </nav>
    
        <a href="/2016/tutorials/faq.html">Tutorial FAQ</a>
      </nav>
    
      <a href="#" class="nav">Concepts</a>
      <nav>
        <a href="/2016/concepts/rpc.html">RPC System</a>
    <a href="/2016/concepts/naming.html">Naming</a>
    <a href="/2016/concepts/security.html">Security</a>
    <a href="/2016/concepts/device-management.html">Device Management</a>
  </nav>
    
      <a href="/2016/example-apps.html">Example Apps</a>
      <a href="/2016/api-reference.html">API Reference</a>
    
      <a href="#" class="nav">Community</a>
      <nav>
        <a href="/2016/community/coding-guidelines.html">Coding Guidelines</a>
    <a href="/2016/community/contributing.html">Contributing</a>
    <a href="/2016/community/mailing-lists.html">Mailing List</a>
    <a href="/2016/community/roadmap.html">Roadmap</a>
  </nav>
    
      <a href="#" class="nav">Tools</a>
      <nav>
        <a href="/2016/tools/identity-service-faq.html">Vanadium Identity Service</a>
    <a href="/2016/tools/jiri.html">Jiri</a>
    <a href="/2016/tools/namespace-browser.html">Namespace Browser</a>
    <a href="/2016/tools/services.html">Vanadium Cloud Services</a>
  </nav>
    
      <a href="#" class="nav">Design Docs</a>
      <nav>
        <a href="/2016/designdocs/authentication.html">Authentication Protocol</a>
    <a href="/2016/designdocs/identity-service.html">Identity Service</a>
    <a href="/2016/designdocs/vdl-spec.html">VDL Specification</a>
    <a href="/2016/designdocs/vom-spec.html">VOM Specification</a>
  </nav>
    
      <a href="/2016/glossary.html">Glossary</a>
      <a href="/2016/faq.html">FAQ</a>
      <a href="/2016/tos.html">Terms of Service</a>
    </div>
    <main>
      <h1 class="title">
        
        The Device Manager
      </h1>

      <p class="wherein"><strong>Wherein</strong> you learn about running applications with the device manager</p>

      <div class="toc"></div>

      <div class="prerequisites">
      <div class="note info"><p><strong>Prerequisites</strong>:<br>
All tutorials require Vanadium <a href="/2016/installation/">installation</a>, and must run in a <a href="/2016/tutorials/faq.html#why-bash-">bash shell</a>.
<br>Further, please <a href="/2016/sh/scenario-b-setup.sh" download="scenario-b-setup.sh"> download this script</a> then <a href="/2016/tutorials/faq.html#why-source-">source</a> it:</p>
<pre><code>source ~/Downloads/scenario-b-setup.sh
</code></pre><p>This command wipes tutorial files and defines shell environment variables. If you start a new terminal, and just want to re-establish the environment, see instructions <a href="/2016/tutorials/setup.html">here</a>.
</p>
<p></p>
</div>
</div>

      <h1 id="introduction">Introduction</h1>
<p>In the <a href="/2016/tutorials/basics.html">basics tutorial</a>, you ran the fortune server as a background process
from the terminal.</p>
<p>In this tutorial, you&#39;ll learn how to use the device manager to run your server
remotely (however, the device manager you&#39;ll be running as part of the tutorial
is running on the same computer to keep things simple).</p>
<h1 id="credentials">Credentials</h1>
<p>We&#39;ll be using default <a href="/2016/tutorials/basics.html#authorization">credentials</a> for all the commands and servers we start
from the terminal. Recall that <code>tutorial</code> is the blessing name for these credentials:</p>
<!-- @setCredentials @test -->
<pre><code>export V23_CREDENTIALS=&quot;$V_TUT/cred/basics&quot;
&quot;${V_BIN}/principal&quot; dump -s
</code></pre><h1 id="install-and-start-a-device-manager">Install and start a device manager</h1>
<p>The <strong>device manager</strong> is a Vanadium application that runs on a device and is
responsible for installing and running other Vanadium applications on behalf of
users.</p>
<p>The first step is to install and start a device manager on your computer (taking
care first to clean up any previous ones). The device manager uses the security
agent introduced in the <a href="/2016/tutorials/security/agent.html">agent tutorial</a> to manage principals for itself and all
the applications run under it.</p>
<p>The device manager has a built-in mount table, which we can us for service
discovery (as we learned in the <a href="/2016/tutorials/naming/mount-table.html">mount table tutorial</a>). So give it a fixed
port.</p>
<!-- @installAndStartDeviceManager @test @sleep -->
<pre><code>export V23_DEVICE_DIR=&quot;$V_TUT/devmgr&quot;
PORT_MT=24000
&quot;${V_BIN}/deviced&quot; stop 2&gt;/dev/null
&quot;${V_BIN}/deviced&quot; uninstall --suid_helper=&quot;${V_BIN}/suidhelper&quot;
V23_CREDENTIALS=&quot;&quot; &quot;${V_BIN}/deviced&quot; install --suid_helper=&quot;${V_BIN}/suidhelper&quot; --agent=&quot;${V_BIN}/agentd&quot; -- --v23.tcp.address=&quot;:$PORT_MT&quot; --name=&quot;&quot;
V23_CREDENTIALS=&quot;&quot; &quot;${V_BIN}/deviced&quot; start
</code></pre><p>Check that the device manager service is mounted in the mount table. This
should print <code>/localhost:24000/devmgr</code>:
<!-- @globMountTable @test --></p>
<pre><code>&quot;${V_BIN}/namespace&quot; glob &quot;/localhost:$PORT_MT/*&quot;
</code></pre><h1 id="claim-the-device-manager">Claim the device manager</h1>
<p>The device manager is currently <strong>unclaimed</strong>, meaning that it does not have a
blessing (other than the one it generates for itself).  The user must <strong>claim</strong>
the device manager to unlock its functionality.  Claiming involves conferring a
blessing, which then becomes the device manager&#39;s default blessing. We&#39;ll bless
our device manager as <code>hal</code>, and verify that the device manager presents itself
as <code>tutorial/hal</code>:</p>
<!-- @claimDeviceManager @test -->
<pre><code>DEVICE_NAME=/localhost:$PORT_MT/devmgr
&quot;${V_BIN}/device&quot; claim &quot;${DEVICE_NAME}/device&quot; hal
&quot;${V_BIN}/vrpc&quot; identify &quot;${DEVICE_NAME}/device&quot;
</code></pre><h1 id="bring-up-a-server">Bring up a server</h1>
<p>We&#39;re now ready to deploy a Vanadium application on the device manager. We&#39;ll
use the fortune server as our application.</p>
<p>First, install the application, recording the installation name:</p>
<!-- @installFortune @test -->
<pre><code>INSTALLATION_NAME=$( \
  &quot;${V_BIN}/device&quot; install-local &quot;${DEVICE_NAME}/apps&quot; \
  fortuneserver &quot;${V_TUT}/bin/server&quot; --service-name=myFortunes \
)
echo &quot;Installed: ${INSTALLATION_NAME}&quot;
</code></pre><p>Then create an instance of the application just installed and run it, providing
the instance with a blessing called <code>fortune</code>. Record the instance name:</p>
<!-- @startFortune @test -->
<pre><code>INSTANCE_NAME=$(&quot;${V_BIN}/device&quot; instantiate &quot;${INSTALLATION_NAME}&quot; fortune)
&quot;${V_BIN}/device&quot; run &quot;${INSTANCE_NAME}&quot;
echo &quot;Instantiated and started: ${INSTANCE_NAME}&quot;
</code></pre><p>Verify that the fortune server app runs with the expected blessing name, <code>tutorial/fortune</code>:
<!-- @identifyFortune @test --></p>
<pre><code>&quot;${V_BIN}/vrpc&quot; identify &quot;/localhost:$PORT_MT/myFortunes&quot;
</code></pre><p>At this point, you can look at the log files from your server. To see what log files are available:
<!-- @listLogFiles @test --></p>
<pre><code> ${V_BIN}/namespace glob &quot;${INSTANCE_NAME}/logs/*&quot;
</code></pre><p>You can use <em>debug logs read</em> to read any of these files. For example:
<!-- @readLogFiles @test --></p>
<pre><code>LOGFILE=`${V_BIN}/namespace glob &quot;${INSTANCE_NAME}/logs/STDOUT-*&quot;`
${V_BIN}/debug logs read $LOGFILE
</code></pre><h1 id="run-the-client">Run the client</h1>
<p>As in the <a href="/2016/tutorials/basics.html">basics tutorial</a>, use the client to make a call to the server:</p>
<!-- @fortuneClient @test -->
<pre><code>&quot;${V_TUT}/bin/client&quot; --server &quot;/localhost:$PORT_MT/myFortunes&quot;
</code></pre><h1 id="cleanup">Cleanup</h1>
<!-- @deviceManagerCleanup @test -->
<pre><code>&quot;${V_BIN}/device&quot; kill &quot;${INSTANCE_NAME}&quot;
&quot;${V_BIN}/deviced&quot; stop
&quot;${V_BIN}/deviced&quot; uninstall --suid_helper=&quot;${V_BIN}/suidhelper&quot;
</code></pre><h1 id="summary">Summary</h1>
<p>You set up a device manager on your computer, and used the <code>device</code> command-line
tool to install and start an application on it.</p>

    </main>
    <nav class="previous-next">
      <a href="/2016/tutorials/management/overview.html" class="previous">
        <div class="icon"><i class="material-icons">arrow_back</i></div>
        <div class="text-wrapper">
          <small>Previous</small>
          <div class="text">
            <span>Overview</span>
          </div>
        </div>
      </a>
</nav>
  </body>
</html>
