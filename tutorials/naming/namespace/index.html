<!DOCTYPE html>
<html><head>
  <meta charset="utf-8">

  <meta name="viewport"
        content="width=device-width,
                  initial-scale=1,
                  minimum-scale=1,
                  maximum-scale=1,
                  user-scalable=no,
                  minimal-ui">

  <link rel="apple-touch-icon" sizes="57x57" href="https://razvanm.github.io/vanadium-website/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://razvanm.github.io/vanadium-website/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="https://razvanm.github.io/vanadium-website/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="https://razvanm.github.io/vanadium-website/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="https://razvanm.github.io/vanadium-website/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://razvanm.github.io/vanadium-website/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="https://razvanm.github.io/vanadium-website/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://razvanm.github.io/vanadium-website/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://razvanm.github.io/vanadium-website/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://razvanm.github.io/vanadium-website/favicons/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://razvanm.github.io/vanadium-website/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="https://razvanm.github.io/vanadium-website/favicons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="160x160" href="https://razvanm.github.io/vanadium-website/favicons/favicon-160x160.png">
  <link rel="icon" type="image/png" sizes="192x192" href="https://razvanm.github.io/vanadium-website/favicons/favicon-192x192.png">
  <meta name="msapplication-TileColor" content="#00acc1">
  <meta name="msapplication-TileImage" content="/favicons/mstile-144x144.png">

  <link href="https://fonts.googleapis.com/css?family=Material+Icons&display=block" rel="stylesheet">
  <link rel="stylesheet" href="https://razvanm.github.io/vanadium-website/bundle.css"/>
</head>
<body>

<div class="w-full fixed top-0">
  <div class="bg-background-svg bg-no-repeat [background-size:100%] py-[16px] px-[12px] flex flex-row">
    <a href="https://razvanm.github.io/vanadium-website/">
      <img src="https://razvanm.github.io/vanadium-website/images/v-icon-white.svg"/>
    </a>

    <div class="text-white pl-[20px] text-[20px] font-medium">
      Vanadium Core
    </div>

    <div class="grow"></div>

    <a href="https://github.com/" class="fill-white">
      <svg viewBox="0 0 16 16" class="w-[32px]">
        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
      </svg>
    </a>
  </div>
</div><div class="fixed top-[64px] left-0 w-[200px] z-10 h-[calc(100%-64px)] bg-gray-50">
  <nav class="overflow-y-auto h-full py-4 pl-4 leading-[20px] text-[14px]">
    <a href="https://razvanm.github.io/vanadium-website/overview">Overview</a>
    <a href="https://razvanm.github.io/vanadium-website/installation">Installation</a>
    <div>Tutorials</div>
    <nav class="pl-3">
      <a href="https://razvanm.github.io/vanadium-website/tutorials/hello-world">Hello World</a>
      <a href="https://razvanm.github.io/vanadium-website/tutorials/basics">Client/Server Basics</a>

      <div>Security</div>
      <nav class="pl-3">
        <a href="https://razvanm.github.io/vanadium-website/tutorials/security">Overview</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/security/principals-and-blessings">Principal and Blessings</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/security/permissions-authorizer">Permissions Authorizer</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/security/first-party-caveats">Caveats</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/security/third-party-caveats">Third-party Caveats</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/security/agent">The Agent</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/security/custom-authorizer">Customer Authorizer</a>
      </nav>

      <div>Naming</div>
      <nav class="pl-3">
        <a href="https://razvanm.github.io/vanadium-website/tutorials/naming">Overview</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/naming/mount-table">The Mount Table</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/naming/namespace">Namespaces</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/naming/suffix-part1">The Suffix - Part I</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/naming/suffix-part2">The Suffix - Part II</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/naming/globber">Globber</a>
      </nav>

      <div>Java</div>
      <nav class="pl-3">
        <a href="https://razvanm.github.io/vanadium-website/tutorials/java">Overview</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/java/fortune">Fortune in Java</a>
        <a href="https://razvanm.github.io/vanadium-website/tutorials/java/android">Location Service in Android</a>
      </nav>

      <a href="https://razvanm.github.io/vanadium-website/tutorials/faq">Tutorial FAQ</a>
    </nav>

    <div>Concepts</div>
    <nav class="pl-3">
      <a href="https://razvanm.github.io/vanadium-website/concepts/rpc">RPC System</a>
      <a href="https://razvanm.github.io/vanadium-website/concepts/naming">Naming</a>
      <a href="https://razvanm.github.io/vanadium-website/concepts/security">Security</a>
      <a href="https://razvanm.github.io/vanadium-website/concepts/device-management">Device Management</a>
    </nav>

    <div>Design Docs</div>
    <nav class="pl-3">
      <a href="https://razvanm.github.io/vanadium-website/designdocs/authentication">Authentication Protocol</a>
      <a href="https://razvanm.github.io/vanadium-website/designdocs/identity-service">Identity Service</a>
      <a href="https://razvanm.github.io/vanadium-website/designdocs/vdl-spec">VDL Specification</a>
      <a href="https://razvanm.github.io/vanadium-website/designdocs/vom-spec">VOM Specification</a>
    </nav>

    <a href="https://razvanm.github.io/vanadium-website/api-reference">API Reference</a>
    <a href="https://razvanm.github.io/vanadium-website/glossary">Glossary</a>
    <a href="https://razvanm.github.io/vanadium-website/faq">FAQ</a>

    <div>Community</div>
    <nav class="pl-3">
      <a href="https://razvanm.github.io/vanadium-website/community/coding-guidelines">Coding Guidelines</a>
      <a href="https://razvanm.github.io/vanadium-website/community/contributing">Contributing</a>
      <a href="https://razvanm.github.io/vanadium-website/community/mailing-lists">Mailing List</a>
      <a href="https://razvanm.github.io/vanadium-website/community/roadmap">Roadmap</a>
    </nav>
  </nav>
</div>

  <div class="hidden xl:block fixed top-[64px] right-0 w-[200px] p-4 text-[14px] border-l-4 border-l-gray-100 h-[calc(100%-64px)]">
    <div class="uppercase font-medium pb-3">Namespaces</div>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#table-in-a-table">Table in a table</a></li>
    <li><a href="#namespace-construction">Namespace construction</a></li>
    <li><a href="#single-table-namespace">Single table namespace</a></li>
    <li><a href="#mixing-remote-and-local">Mixing remote and local</a></li>
    <li><a href="#cycles-ok">Cycles OK</a></li>
    <li><a href="#cleanup">Cleanup</a></li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
  </div>

<div class="flex flex-col h-screen pt-[64px]">
  <div class="ml-[200px] px-11 w-[800px]">
    <h1 class="text-primary-color text-[48px]">Namespaces</h1>

    
    <p><strong>Wherein</strong> you manipulate multiple mount tables to create a rich namespace.</p>
    
  <div class="my-8 -mx-4 px-4 border border-blue-grey-50/100 rounded">
    <p>
      <strong>Prerequisites</strong>:<br>
      All tutorials require Vanadium <a href="https://razvanm.github.io/vanadium-website/installation/">installation</a>,
      and must run in a <a href="https://razvanm.github.io/vanadium-website/tutorials/faq.html#why-bash-">bash shell</a>.
    </p>

    
      <p>
        Further, please
        <a href="https://razvanm.github.io/vanadium-website/sh/scenario-b-setup.sh"
           download="scenario-b-setup.sh">
           download this script
        </a>
        then <a href="https://razvanm.github.io/vanadium-website/tutorials/faq.html#why-source-">source</a> it:
      </p>

      <pre><code>source ~/Downloads/scenario-b-setup.sh</code></pre>

      <p>
        This command wipes tutorial files and defines shell environment
        variables. If you start a new terminal, and just want to re-establish
        the environment, see instructions
        <a href="https://razvanm.github.io/vanadium-website/tutorials/setup.html">here</a>.
      </p>
    

    
  </div>

<content>
      <h1 id="introduction">Introduction</h1>
<p>As done in the mount table tutorial, this tutorial will use just
<a href="https://razvanm.github.io/vanadium-website/2016/tutorials/naming/mount-table.html#credentials">one set of credentials</a> for all processes:</p>
<!-- @setCredentials @test -->
<pre tabindex="0"><code>export V23_CREDENTIALS=$V_TUT/cred/basics
</code></pre><p>This tutorial will use three distinct mount table servers, named
<code>HOME</code>, <code>METERS</code> and <code>UTILITY</code>.  These names are in uppercase to
distinguish them from service names used in table entries, where we&rsquo;ll
stick with a lowercase convention.</p>
<p>Start <code>HOME</code> first:</p>
<!-- @startTableHome @test @sleep -->
<pre tabindex="0"><code>PORT_MT_HOME=23000  # Pick an unused port.
kill_tut_process TUT_PID_MT_HOME
$V_BIN/mounttabled --v23.tcp.address :$PORT_MT_HOME &amp;
TUT_PID_MT_HOME=$!
</code></pre><p>Start a fortune server:</p>
<!-- @startFortune @test @sleep -->
<pre tabindex="0"><code>kill_tut_process TUT_PID_SERVER
$V_TUT/bin/server \
    --endpoint-file-name $V_TUT/server.txt &amp;
TUT_PID_SERVER=$!
</code></pre><p>Add the fortune server to table <code>HOME</code>, and for reasons explained
below, call it <code>television</code>:</p>
<!-- @mountFortune @test -->
<pre tabindex="0"><code>$V_BIN/namespace \
    --v23.namespace.root /localhost:$PORT_MT_HOME \
    mount television `cat $V_TUT/server.txt` 2h
</code></pre><h1 id="table-in-a-table">Table in a table</h1>
<p>Like any Vanadium service, a mount table can be mounted in a mount
table.</p>
<p>Start table <code>METERS</code>:</p>
<!-- @startTableMeters @test @sleep -->
<pre tabindex="0"><code>PORT_MT_METERS=$(( $PORT_MT_HOME + 1 ))
kill_tut_process TUT_PID_MT_METERS
$V_BIN/mounttabled --v23.tcp.address :$PORT_MT_METERS &amp;
TUT_PID_MT_METERS=$!
</code></pre><p>Mount it in table <code>HOME</code> at the name <code>meters</code>:</p>
<!-- @tableInATable @test -->
<pre tabindex="0"><code>$V_BIN/mounttable \
    --v23.namespace.root /localhost:$PORT_MT_HOME \
    mount meters /localhost:$PORT_MT_METERS 2h M
</code></pre><p>The trailing <code>M</code> sets a bit in the mount table noting that this
particular service happens to be a table.</p>
<p>{{# helpers.info }}</p>
<p><code>mounttable</code> and <code>namespace</code> are distinct tools with <em>almost</em> the same
abilities (see their help).  The <code>mounttable</code> tool doesn&rsquo;t
do name resolution and speaks directly to a single mount table.
The <code>namespace</code> tool behaves more like a normal Vanadium client.
{{/ helpers.info }}</p>
<p>The <code>HOME</code> table now has two entries, <code>meters</code> and <code>television</code>:</p>
<!-- @firstGlobOfHome @test -->
<pre tabindex="0"><code>$V_BIN/namespace \
    --v23.namespace.root /localhost:$PORT_MT_HOME \
    glob '*'
</code></pre><p>That exercises the basic commands needed to manipulate namespace.</p>
<h1 id="namespace-construction">Namespace construction</h1>
<p>The <code>METERS</code> table is empty right now, so lets add two services to it.
To save time, reuse the fortune service that&rsquo;s already running.  New,
distinct instances wouldn&rsquo;t make any difference to this example.</p>
<p>Mount the services as <code>gas</code> and <code>electric</code> in the <code>METERS</code> table:</p>
<!-- @mountGas @test -->
<pre tabindex="0"><code>$V_BIN/namespace \
    --v23.namespace.root /localhost:$PORT_MT_METERS \
    mount gas `cat $V_TUT/server.txt` 2h
</code></pre><!-- @mountElectricFortune @test -->
<pre tabindex="0"><code>$V_BIN/namespace \
    --v23.namespace.root /localhost:$PORT_MT_METERS \
    mount electric `cat $V_TUT/server.txt` 2h
</code></pre><p>The namespace you&rsquo;ve built is represented here:</p>
<p><img src="https://razvanm.github.io/vanadium-website/2016/images/tut/namespace-home-simple.svg" alt="The HOME namespace"></p>
<p>Query the <code>HOME</code> table again, but this time
stead of <code>*</code>, try <code>...</code> as an argument to <code>namespace glob</code>:</p>
<!-- @queryTableInATable @test -->
<pre tabindex="0"><code>$V_BIN/namespace \
    --v23.namespace.root /localhost:$PORT_MT_HOME \
    glob '...'
</code></pre><p>This shows <code>television</code>, <code>meters</code>, <code>meters/gas</code> and <code>meters/electric</code>
along with endpoints.</p>
<p>This means services available as root names to clients of <code>METERS</code> are
now also available to clients of <code>HOME</code>.  For example, you can read
the <code>gas</code> meter via the <code>HOME</code> table:</p>
<!-- @fortuneNestedInTable @test -->
<pre tabindex="0"><code>$V_TUT/bin/client \
    --v23.namespace.root /localhost:$PORT_MT_HOME \
    --server meters/gas
</code></pre><p>Your television could display data from <code>meters/gas</code> or <code>meters/electric</code>.
Likewise, other services like <code>mediaServer</code> and <code>doorLock</code> can be
mounted in your <code>HOME</code>, making them discoverable by the <code>television</code>.
The <code>HOME</code> table is your home&rsquo;s <strong>namespace root</strong>.</p>
<h1 id="single-table-namespace">Single table namespace</h1>
<p>The name to service mapping supported by the above arrangement can
also be done with a single mount table, like this:</p>
<p><img src="https://razvanm.github.io/vanadium-website/2016/images/tut/namespace-home-direct.svg" alt="Single table namespace"></p>
<p>That is, we could have omitted the <code>METERS</code> table entirely, and
mounted the service in <code>HOME</code> at the name <code>meters/gas</code> with this
alternative to the command used above (<strong>don&rsquo;t do this now!</strong>):</p>
<!-- @mountElectricFortune @test -->
<pre tabindex="0"><code>$V_BIN/namespace \
    --v23.namespace.root /localhost:$PORT_MT_HOME \
    mount meters/gas `cat $V_TUT/server.txt` 2h
</code></pre><p>The trick is simply to use the special delimiter <code>/</code> directly in a
name.</p>
<p>One might do this for the same reason one would group files in
particular folders on a computer, but it means giving up the ability
to export parts of your namespace to others, as described in the next
section.</p>
<h1 id="mixing-remote-and-local">Mixing remote and local</h1>
<p>With the proper blessings you could safely mount your <code>METERS</code> table
in a city-wide utility company table under your account number
<code>12345</code>.</p>
<p>Let&rsquo;s start another table <code>UTILITY</code>:</p>
<!-- @startTableUtility @test @sleep -->
<pre tabindex="0"><code>PORT_MT_UTILITY=$(( $PORT_MT_METERS + 1 ))
kill_tut_process TUT_PID_MT_UTILITY
$V_BIN/mounttabled --v23.tcp.address :$PORT_MT_UTILITY &amp;
TUT_PID_MT_UTILITY=$!
</code></pre><p>Now mount your <code>METERS</code> in it, at a particular account number
<code>12345</code>:</p>
<!-- @mountMetersInUtility @test -->
<pre tabindex="0"><code>$V_BIN/mounttable \
    --v23.namespace.root /localhost:$PORT_MT_UTILITY \
    mount 12345 /localhost:$PORT_MT_METERS 5h M
</code></pre><p>The utility company can see the table you call <code>METERS</code> as an account
number <code>12345</code> - and the utility can see its children <code>gas</code> and
<code>electric</code>.</p>
<p>The utility company has no pointer to your <code>mediaServer</code> or other home
services, by virtue of the meter table&rsquo;s independent existence.</p>
<p>You likely <em>don&rsquo;t</em> want to mount all your local services in a
neighborhood, city or national table (Vanadium security measures would
prevent this anyway to avoid the equivalent of DNS poisoning).</p>
<p>But you <em>do</em> want to access global services locally, so you (or some
software under your control) would mount appropriate public tables
locally.  That way your <code>television</code> can discover
<code>GOOGLE/PLAY/MOVIES/starwars</code> (after <code>GOOGLE</code> is mounted locally).</p>
<p>As an example of this, mount the <code>UTILITIES</code> table in <code>HOME</code>:</p>
<!-- @mountUtilitiesInHome @test -->
<pre tabindex="0"><code>$V_BIN/mounttable \
    --v23.namespace.root /localhost:$PORT_MT_HOME \
    mount cityUtilities /localhost:$PORT_MT_UTILITY 5h M
</code></pre><p><img src="https://razvanm.github.io/vanadium-website/2016/images/tut/namespace-home-extended.svg" alt="The HOME namespace"></p>
<p>Now, your television could display your gas usage by hitting the name
<code>METERS/gas</code> (done above) or by hitting the name
<code>cityUtilities/12345/gas</code>:</p>
<!-- @readGas @test -->
<pre tabindex="0"><code>$V_TUT/bin/client \
    --v23.namespace.root /localhost:$PORT_MT_HOME \
    --server cityUtilities/12345/gas
</code></pre><h1 id="cycles-ok">Cycles OK</h1>
<p>The fact that your gas meter is available via two distinct paths
raises the question of cycles.  Cycles aren&rsquo;t prohibited.</p>
<p>To see what happens, mount the <code>UTILITY</code> table in the <code>METERS</code> table
with a short name <code>x</code>:</p>
<!-- @mountUtilityInMeters @test -->
<pre tabindex="0"><code>$V_BIN/mounttable \
    --v23.namespace.root /localhost:$PORT_MT_METERS \
    mount x /localhost:$PORT_MT_UTILITY 5h M
</code></pre><p>Now read your gas meter via a name with cycles:</p>
<!-- @longName @test -->
<pre tabindex="0"><code>$V_TUT/bin/client \
    --v23.namespace.root /localhost:$PORT_MT_HOME \
    --server meters/x/12345/x/12345/x/12345/x/12345/gas
</code></pre><p>Infinite cycles in namespace resolution are prevented by counting steps
(there&rsquo;s an upper limit on the <code>/</code> count in any name).</p>
<p>Use <code>namespace resolve</code> to see that you&rsquo;re accessing the same service:</p>
<!-- @moreResolving @test -->
<pre tabindex="0"><code>name1=$($V_BIN/namespace \
    --v23.namespace.root /localhost:$PORT_MT_HOME \
    resolve meters/x/12345/x/12345/x/12345/x/12345/gas)
name2=$($V_BIN/namespace \
    --v23.namespace.root /localhost:$PORT_MT_METERS \
    resolve gas)
echo &quot;These should match:&quot;
echo -e &quot;$name1\n$name2&quot;
</code></pre><p>Of course <code>television</code> will also resolve to this name because we&rsquo;re
reusing the same service.  Feel free to go back and start fresh server
instances for <code>gas</code> and <code>electric</code> and do the same commands to assure
yourself that <code>gas</code> doesn&rsquo;t get confused with <code>electric</code> or
<code>television</code>.</p>
<p>Take a look all at the path expansions using <code>namespace glob ...</code>:</p>
<!-- @queryTableInATable @test -->
<pre tabindex="0"><code>$V_BIN/namespace \
    --v23.namespace.root /localhost:$PORT_MT_HOME \
    glob '...'
</code></pre><h1 id="cleanup">Cleanup</h1>
<!-- @cleanup @test -->
<pre tabindex="0"><code>kill_tut_process TUT_PID_SERVER
kill_tut_process TUT_PID_MT_HOME
kill_tut_process TUT_PID_MT_METERS
kill_tut_process TUT_PID_MT_UTILITY
unset V23_CREDENTIALS
</code></pre><h1 id="summary">Summary</h1>
<ul>
<li>
<p>The command-line client <code>mounttable</code> supplements <code>namespace</code> to
perform general operations on an instance of <code>mounttabled</code>.</p>
</li>
<li>
<p>Mount tables can be mounted on each other to create isolated
namespaces.</p>
</li>
<li>
<p>Mounting a table in another table can be viewed as exporting a
subset of a namespace.</p>
</li>
<li>
<p>The <code>namespace glob ...</code> command shows service path expansions.</p>
</li>
<li>
<p>Namespace cycles are allowed and controlled by counting.</p>
</li>
</ul>

    </content>
 </div>

 <nav class="flex flex-wrap-reverse mt-6 ml-[200px] z-[1]">
  
    
      <a href="https://razvanm.github.io/vanadium-website/tutorials/naming/mount-table/" class="p-8 flex justify-start items-center bg-cyan-800 grow">
        <div class="flex items-center justify-center w-[48px] h-[48px]">
          <i class="material-icons text-white">arrow_back</i>
        </div>
        <div class="flex flex-col items-start">
          <div class="text-white/70 text-xs">Previous</div>
          <div class="text-white">The Mount Table</div>
        </div>
      </a>
    
  

  
    
      <a href="https://razvanm.github.io/vanadium-website/tutorials/naming/suffix-part1/" class="p-8 flex justify-end items-center bg-primary-color grow">
        <div class="flex flex-col items-end">
          <div class="text-white/70 text-xs">Next</div>
          <div class="text-white">The Suffix - Part I</div>
        </div>
        <div class="flex items-center justify-center w-[48px] h-[48px]">
          <i class="material-icons text-white">arrow_forward</i>
        </div>
      </a>
    
  
</nav>

  
</div>

</body>
</html>
